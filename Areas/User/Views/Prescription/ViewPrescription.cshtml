@model IEnumerable<Psychiatrist_Management_System.Models.PrescriptionVM>

<div class="container">

    <h2 class="text-center text-white bg-info p-2 rounded">Prescription</h2>

    @if (Model.Any())
    {
        var first = Model.First();

        <!-- Info Section -->
        <div class="info-section">
            <div class="patient-info">
                <h4>Patient Info</h4>
                <p><label>Name:</label> <span class="underline">@first.PatientName</span></p>
                <p><label>Age:</label> <span class="underline">@first.Age</span></p>
                <p><label>Address:</label> <span class="underline">@first.Address</span></p>
            </div>
            <div class="doctor-info">
                <h4>Psychiatrist Info</h4>
                <p><label>Name:</label> <span class="underline">@first.PsychiatristName</span></p>
                <p><label>Qualification:</label> <span class="underline">@first.Specialization</span></p>
                <p><label>Booking No:</label> <span class="underline">@first.BookingSerial</span></p>
                <p><label>Contact:</label> <span class="underline">@first.Age</span></p>
            </div>
        </div>

        <p><label>Identity Marks:</label> <span class="underline">@first.Diagnosed</span></p>
        <!-- Prescription Table -->
        <div class="section">
            <h4>Prescription Details</h4>
            <table>
                <thead>
                    <tr>
                        <th>Sr.</th>
                        <th>Medicine</th>
                        <th>Notes</th>
                        <th>Dose</th>
                        <th>Duration</th>
                        <th>Frequency</th>
                        <th>Advice</th>
                    </tr>
                </thead>
                <tbody>
                    @{
                        int sr = 1;
                    }
                    @foreach (var med in Model)
                    {
                        <tr>
                            <td>@sr</td>
                            <td>@med.MedicineName</td>
                            <td>@med.Medicine_Notes</td>
                            <td>@med.MedicineDose</td>
                            <td>@med.MedicineDuration</td>
                            <td>@med.Frequency</td>
                            <td>@med.Advice</td>
                        </tr>
                        sr++;
                    }
                </tbody>
            </table>
        </div>

        <!-- Advice -->
        <div class="section advice">
            <h4>Advice / Diet Instructions</h4>
            <p>@first.Advice</p>
        </div>

        <!-- Signatures -->
        <div class="section signature">
            <div>Doctor’s Signature</div>
            <div>Authentication</div>
        </div>

        <!-- Print Button -->
        <div class="text-center mt-3">
            <button id="printBtn">Print / Download PDF</button>
        </div>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
        <script>
            document.getElementById("printBtn").addEventListener("click", function () {
                const element = document.querySelector(".container");
                html2pdf().set({
                    margin: 0.5,
                    filename: 'Prescription.pdf',
                    image: { type: 'jpeg', quality: 0.98 },
                    html2canvas: { scale: 2 },
                    jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
                }).from(element).save();
            });
        </script>
    }
    else
    {
        <p class="text-danger">No prescription data found.</p>
    }
</div>

<style>
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: #f3f3f3;
        color: #000;
        margin: 0;
    }


    
    .info-section {
        display: flex;
        justify-content: space-between;
        gap: 10px; /* komano gap */
        margin: 10px 0; /* komano top-bottom margin */
        background: #e9f7ff;
        padding: 8px; /* komano padding */
        border-radius: 6px;
    }

    .patient-info h4, .doctor-info h4 {
        margin: 0 0 4px 0; /* heading er niche kom margin */
        font-size: 14px;
    }

    .patient-info p, .doctor-info p {
        margin: 2px 0; /* p er margin komano */
        font-size: 13px;
    }

    label {
        font-weight: 600;
        width: 90px; /* slightly komano width */
        display: inline-block;
    }

    .underline {
        border-bottom: 1px solid #000;
        min-height: 16px;
        display: inline-block;
        width: calc(100% - 95px);
    }
    .container {
        max-width: 800px;
        margin: 20px auto;
        padding: 20px 25px;
        background: #fff;
        border-radius: 10px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    .info-section {
        display: flex;
        justify-content: space-between;
        gap: 15px;
        margin: 15px 0;
        background: #e9f7ff;
        padding: 10px;
        border-radius: 8px;
    }

    .patient-info, .doctor-info {
        flex: 1;
    }

    label {
        font-weight: 600;
        width: 110px;
        display: inline-block;
    }

    .underline {
        border-bottom: 1px solid #000;
        min-height: 18px;
        display: inline-block;
        width: calc(100% - 120px);
    }

    table {
        width: 100%;
        border-collapse: collapse;
        font-size: 13px;
        margin-top: 10px;
    }

    th, td {
        border: 1px solid #ccc;
        padding: 6px 5px;
        text-align: center;
    }

    th {
        background-color: #f0f0f0;
    }

    .section {
        margin-top: 15px;
    }

    .advice {
        min-height: 40px;
        padding: 5px;
    }

    .signature {
        display: flex;
        justify-content: space-between;
        margin-top: 20px;
    }

        .signature div {
            width: 48%;
            text-align: center;
            border-top: 1px solid #000;
            padding-top: 5px;
            font-weight: 600;
        }

    button {
        background-color: #007bff;
        color: #fff;
        border: none;
        border-radius: 5px;
        padding: 8px 18px;
        cursor: pointer;
    }

        button:hover {
            background-color: #0056b3;
        }
</style>
